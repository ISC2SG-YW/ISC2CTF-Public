#!/usr/bin/env python3
#Method 1
from Crypto.Util import number

N = 0x8a59e1c7783d4a67f4be5dd44459b9762709a5c9895f94020de05ebc414f8939cb4fef337e233d219375a59553ef0278771cfc29325bd548ab0fc71004aa4f0dd77b6721b485e7bc32053c32109b1fc21ac099c69db8e70f368c1aeb92606fda32e3f0afab18bb94f070a03958dc2d43bd7b08e89b4e6c49354ebe340b2161b189822bf2dbecd4fce4c5998a2fe73a1b72367f8c21e984f0f48038eeb00b21d0dbd788227e548922b595931c2a09ca18738d96ea5a6aad6ea699e31fff783539f2b880630575779cd543a69664ac4f5da3305af5063a559fb28db32e543acf4610debcfd416c3ab366c8e333a861487b27647deeff1707b97d872fecdfbf2d6d
e = 0x85532d90997823d449c7ade412318d757a5dd60a48114d6f6c59bcd5f9f25040f722db53d07f633ba36d113c53b8e4d8065a90ae238ccbe9a118fae6a4bdf660cb6a7c7d2792401dd786a66728c7122668137a723e8bdc35d72beb17288b8b85a7d6d049e6ced39c7b4fafec09895ed84cda106878546fabebcae0b58a61126c9c7516657fcf52380505e10e738724635d1a35afd2a5748662dbe8d9d23d9303266e35508d31121ffa6e1d8c338a20c5a84fdebd70c7bfe19cc4a4ce3ad38c20c467364398a30427f06b7232e3037f6f68440f8d5e5a01d53dd454a4c7e496963aa61bba2bef1fbcf5972c6340e81969543817343351024c678d42af6e93cc4d
c = 0x82156dd82c953cb3c2dbce38c8295cc2e828098090bf8f9ec23c96bd2b71862e14d5e17a8b67be76081babb86647fee540642f66f96a8c76d198f9a70f316cdcc3b901bb26a7d36b090a89e9b5a02c9238b4b177ce7d0ee5b8bc64ff1f88d34b36c51786a233e33aae3752830d7915f7821e16dbf866b4fe0747682e4aa80650979e102c4fe1880ef4792c93efdbe765e761959f9802abc6baf44c4adffcb10adb71d08c2e53f52ad6d5a33547b1bd167f9401aa6e90f089e63cc704281670d2fc116c1d56368323aa763bf59de3f58f1dbe5e482a24a36fe2d607394b2b1462ab6d5f5898ccd06a911a2714ba791a06f3fcbb60da6e5ec877e68aed256a0b0d

p = 98444549679044409506244239144443867459824227934526036052949278261505813439015297459200379108752444235232667213138464076415095486907288282630595622287237215801470940146886371515679909322090871473412384894540642399950010296214525469622505798526072170187467562765920044646574445427364231529083610955760228212701
q = 131205304707717699800023219057082007986286045823683571663112014612188606710079038751853416273709729039622908861933527111469616900188875912430487264576215232569029320804579614330240773622645122871884209068761138439268551367198798009790636662892148063583135747945604771740458352899202428704645256790931460695949

phi = (q-1)*(p-1)

# TODO
# e is too big for Wiener's Attack
# use Boneh's attack instead
# https://sagi.io/2016/04/crypto-classics-wieners-rsa-attack/
d = number.inverse(e, phi)
print(number.long_to_bytes(pow(c, d, N)))

#Method 2:
import owiener
from Crypto.Util.number import long_to_bytes

N = 0x8a59e1c7783d4a67f4be5dd44459b9762709a5c9895f94020de05ebc414f8939cb4fef337e233d219375a59553ef0278771cfc29325bd548ab0fc71004aa4f0dd77b6721b485e7bc32053c32109b1fc21ac099c69db8e70f368c1aeb92606fda32e3f0afab18bb94f070a03958dc2d43bd7b08e89b4e6c49354ebe340b2161b189822bf2dbecd4fce4c5998a2fe73a1b72367f8c21e984f0f48038eeb00b21d0dbd788227e548922b595931c2a09ca18738d96ea5a6aad6ea699e31fff783539f2b880630575779cd543a69664ac4f5da3305af5063a559fb28db32e543acf4610debcfd416c3ab366c8e333a861487b27647deeff1707b97d872fecdfbf2d6d
e = 0x85532d90997823d449c7ade412318d757a5dd60a48114d6f6c59bcd5f9f25040f722db53d07f633ba36d113c53b8e4d8065a90ae238ccbe9a118fae6a4bdf660cb6a7c7d2792401dd786a66728c7122668137a723e8bdc35d72beb17288b8b85a7d6d049e6ced39c7b4fafec09895ed84cda106878546fabebcae0b58a61126c9c7516657fcf52380505e10e738724635d1a35afd2a5748662dbe8d9d23d9303266e35508d31121ffa6e1d8c338a20c5a84fdebd70c7bfe19cc4a4ce3ad38c20c467364398a30427f06b7232e3037f6f68440f8d5e5a01d53dd454a4c7e496963aa61bba2bef1fbcf5972c6340e81969543817343351024c678d42af6e93cc4d
c = 0x82156dd82c953cb3c2dbce38c8295cc2e828098090bf8f9ec23c96bd2b71862e14d5e17a8b67be76081babb86647fee540642f66f96a8c76d198f9a70f316cdcc3b901bb26a7d36b090a89e9b5a02c9238b4b177ce7d0ee5b8bc64ff1f88d34b36c51786a233e33aae3752830d7915f7821e16dbf866b4fe0747682e4aa80650979e102c4fe1880ef4792c93efdbe765e761959f9802abc6baf44c4adffcb10adb71d08c2e53f52ad6d5a33547b1bd167f9401aa6e90f089e63cc704281670d2fc116c1d56368323aa763bf59de3f58f1dbe5e482a24a36fe2d607394b2b1462ab6d5f5898ccd06a911a2714ba791a06f3fcbb60da6e5ec877e68aed256a0b0d

d = owiener.attack(e, N)

if d:
    print(long_to_bytes(pow(c, d, N)).decode())
else:
    print('L.')